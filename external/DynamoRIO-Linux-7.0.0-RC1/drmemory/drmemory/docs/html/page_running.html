<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>
<title>Dr. Memory: Running Dr. Memory</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Dr. Memory
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_running.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Running Dr. Memory </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Once you have installed Dr. Memory and built your application properly, the next step is to execute it on your workload of choice under Dr. memory.</p>
<p>To fuzz test an application, use Dr. Memory's <a class="el" href="page_fuzzer.html">Fuzz Testing Mode</a>.</p>
<h1><a class="anchor" id="sec_vstudio"></a>
Dr. Memory as a Visual Studio Tool</h1>
<p>Dr. Memory has support for running within the Visual Studio IDE as an External Tool. The Windows installer automatically creates a new Tools menu entry for launching Dr. Memory for each version of Visual Studio detected at install time. If you are using a local install, or if you installed Visual Studio after installing Dr. Memory, or if you are using Visual Studio Express 2010 and it was in Basic mode at the time you installed Dr. Memory, you will need to follow the following instructions in order to add Dr. Memory as an External Tool.</p>
<p>If using Visual Studio Express 2010, first enable the full menu system by selecting <code>Tools | Settings | Expert Settings</code> (this step is not necessary for Visual Studio Professional or later versions of Visual Studio Express).</p>
<p>Next, for Visual Studio 2005 through 2012, select the <code>Tools | External Tools...</code> menu option to open the External Tools dialog box. Click Add and fill in the fields as follows (adjusting the path to <code>drmemory.exe</code> if you installed it somewhere else):</p>
<pre class="fragment">Title: Dr. Memory
Command: C:\Program Files (x86)\Dr. Memory\bin\drmemory.exe
Arguments: -visual_studio -- $(TargetPath)
Initial Directory: $(TargetDir)
</pre><p>Check the <code>Use Output window</code> checkbox. Click OK.</p>
<p>For Visual Studio 6, select <code>Tools | Customize</code>, then the <code>Tools</code> tab, and then click the <code>New</code> button. Fill in the fields as above, though the <code>Title</code> field is instead the input box in the main list. Also, you'll want quotes around the TargetPath variable (but you do not want quotes for any later Visual Studio version):</p>
<pre class="fragment">Command: C:\Program Files\Dr. Memory\bin\drmemory.exe
Arguments: -visual_studio -- "$(TargetPath)"
Initial Directory: $(TargetDir)
</pre><p>Now you can select <code>Tools | Dr. Memory</code> and Visual Studio will run your application. The output of Dr. Memory (along with your program) will be printed to the Output Window. You can double-click on a source file on any callstack frame in order to automatically open up that file to the line number indicated.</p>
<p>To pass arguments to your application, in the External Tools dialog box entry for Dr. Memory, either directly add them for all runs, or check the "Prompt for arguments" checkbox to be prompted for arguments on each invocation. Add application arguments at the end, after the pre-filled-in string:</p>
<pre class="fragment">-visual_studio -- $(TargetPath) ADD ARGUMENTS HERE
</pre><p>.</p>
<p>For Dr. Memory as an External Tool set up by the Dr. Memory installer, prompting for arguments is on by default.</p>
<h1><a class="anchor" id="sec_invocation"></a>
Invoking Dr. Memory from the Command Line</h1>
<p>Run your application as you normally would from a command prompt (on Windows, either the <code>cmd</code> shell or a Cygwin prompt), with <code>drmemory</code> and "--" prefixed to the command line (the "--" separates any arguments to Dr. Memory from the application being run).</p>
<p>On Windows: </p><pre class="fragment">drmemory.exe -- c:/path/to/my/app args to my app
</pre><p>On Linux, Mac, or an Android native application: </p><pre class="fragment">drmemory -- /path/to/my/app args to my app
</pre><p>Examples throughout the rest of the documentation will use just one platform, but can readily be adapted to the other by changing the front-end (<code>drmemory.exe</code> or <code>drmemory</code>) and the path style.</p>
<p>If as part of <a class="el" href="page_install.html">Installing Dr. Memory</a> you did not add Dr. Memory to your path, you'll need to specify the full path to Dr. Memory.</p>
<p>On Windows, you can also drag-and-drop your application onto <code>drmemory.exe</code> in Windows Explorer or on the Desktop if you requested a Desktop shorcut upon installation.</p>
<p>For Java applications on Android, see the information under Preparing Your Application for <a class="el" href="page_prep.html#sec_prep_android">Android</a>.</p>
<p>When running scripts it is best to explicitly invoke the interpreter rather than invoking the script directly. For example:</p>
<pre class="fragment">drmemory -- /usr/bin/perl ./myscript.pl
</pre><h1><a class="anchor" id="sec_results"></a>
Examining the Results</h1>
<p>Dr. Memory's results are written to a file called <code>results.txt</code> inside a subdirectory created for each invocation of Dr. Memory, inside Dr. Memory's log directory. The log directory by default is the <code>logs</code> subdirectory of the unpacked installation, or the Dr. Memory directory inside your profile directory when Dr. Memory is installed into <code>Program Files</code> on Windows. It can be changed with the <code>-logdir</code> option:</p>
<pre class="fragment">drmemory.exe -logdir c:/logs -- c:/path/to/my/app
</pre><p>When an application is executed under Dr. Memory's control, it creates a subdirectory in the base log directory named "DrMemory-&lt;appname&gt;.&lt;pid&gt;.NNN", where NNN is a counter that is incremented to ensure unique names.</p>
<p>On Windows, the results files is automatically opened in <code>notepad</code> when the application exits. This only occurs for the top-level process; if it created child processes, they will be followed by Dr. Memory and have their own result directories and files, but these will not be automatically displayed. The option <code>-batch</code> can be used to disable the launch of <code>notepad</code> at application exit.</p>
<p>For full details on each type of error reported by Dr. Memory, see <a class="el" href="page_types.html">Error Types Reported by Dr. Memory</a>.</p>
<p>If you would like to attach a debugger at the point an error is first detected, use the <code>-pause_at_unaddressable</code> or <code>-pause_at_uninitialized</code> options (see <a class="el" href="page_options.html">Dr. Memory Runtime Option Reference</a>).</p>
<h2><a class="anchor" id="sec_potential_errors"></a>
Application Versus System Library Errors</h2>
<p>Current versions of Dr. Memory can end up reporting uninitialized read and leak errors in system library code on large Windows applications. Future Dr. Memory versions will eliminate these errors, but for now these likely false positive errors are listed in a separate file from the normal <code>results.txt</code> called <code>potential_errors.txt</code>. The count of such errors is listed in the <code>ERRORS IGNORED</code> section of the main error summary. For example: </p><pre class="fragment">ERRORS IGNORED:
     17 potential error(s) (suspected false positives)
         (details: D:\drmemory\logs\DrMemory-myapp.exe.5144.000\potential_errors.txt)
     24 potential leak(s) (suspected false positives)
         (details: D:\drmemory\logs\DrMemory-myapp.exe.5144.000\potential_errors.txt)
</pre><p>It is possible that some of these errors are in fact application errors in parameters passed to system library routines where those parameters are not used or read until deep into a system library callstack, though they are suspected of being false positives due to being reported in several layers of system library code. The pattern checking used to identify system libraries whose errors should be reported separately can be tuned via two features, a blacklist and a whitelist. Each feature contains patterns against which file paths are matched. These patterns can contain <code>*</code> or <code></code>? wildcards.</p>
<p>The whitelist takes precedence and if set the blacklist is ignored. The whitelist is empty by default. The option <code>-lib_whitelist</code> contains a ;-separated sequence of patterns against which library or executable paths are matched. The option <code>-lib_whitelist_frames</code> controls how many of the top frames in each callstack are matched. If a whitelist pattern appears in any of those top frames, an error is reported normally. Otherwise, it is separated as a potential error. The expected usage model is to populate the whitelist with a list of paths in which application libraries or executables reside, to limit the error reports to those paths.</p>
<p>The blacklist is controlled by parallel options <code>-lib_blacklist</code> and <code>-lib_blacklist_frames</code>. Running with <code>-lib_blacklist_frames 0</code> will disable the blacklist and report all errors as application errors in <code>results.txt</code>. When non-zero, it controls how many of the top frames must all match the blacklist before an error is separated as a potential error. The blacklist is only enabled by default on Windows, where it is set to <code>$SYSTEMROOT*</code>.d??.</p>
<p>An additional whitelist based on source file paths is available under the options <code>-src_whitelist</code> and <code>-src_whitelist_frames</code>. If combined with <code>-lib_whitelist</code>, the library-based whitelist acts first, with the source file-based whitelist filtering the errors that remain.</p>
<p>If many false positives are being reported and additional performance is desired at the risk of not detecting all application errors, Dr. Memory's <a class="el" href="page_light.html">Light Mode</a> can be used to disable checking for uninitialized reads and leaks.</p>
<h2><a class="anchor" id="sec_no_uninit_checks"></a>
Eliminating Uninitialized Read Checks By Library</h2>
<p>Dr. Memory has an additional type of blacklist beyond the blacklist for system library errors described in <a class="el" href="page_running.html#sec_potential_errors">Application Versus System Library Errors</a>. This blacklist is controlled by the option <code>-check_uninit_blacklist</code>, which is a ,-separated list of library names. Unlike the other blacklist, these names are basenames and not whole paths, as they are meant to correspond to library names given in suppression files. For each library on this list, Dr. Memory will not report any uninitialized reads while directly executing the library's code. This is a more efficient means to eliminate errors than using suppressions or the <code>-lib_blacklist</code> option, but it only applies to uninitialized reads.</p>
<p>When Dr. Memory sees a whole-module suppression &ndash; a suppression containing only a single frame of the form "name!*" &ndash; it automatically adds "name" to the <code>-check_uninit_blacklist</code> option list.</p>
<h1><a class="anchor" id="sec_children"></a>
Controlling Child Processes</h1>
<p>By default, Dr. Memory monitors all child processes. To disable this behavior and not monitor any children, use this option:</p>
<pre class="fragment">drmemory.exe -no_follow_children -- c:/path/to/my/app
</pre><p>On Windows, to follow all children except certain applications, run this command with the executable name of each application you do not wish to monitor, prior to running Dr. Memory with default options:</p>
<pre class="fragment">drconfig.exe -quiet -reg &lt;myapp&gt; -norun
</pre><p>Where "myapp" is the basename of your executable (i.e., the file name without any directories).</p>
<p>The <code>drconfig.exe</code> tool is in the same directory as <code>drmemory.exe</code> and is only available on Windows in the current release.</p>
<p>This <code>-norun</code> request is permanent and affects all subsequent Dr. Memory executions by the user that issued the <code>-norun</code> request. To undo it, use this command:</p>
<pre class="fragment">drconfig.exe -quiet -unreg &lt;myapp&gt;
</pre><h1><a class="anchor" id="sec_daemon"></a>
Applications That Do Not Exit</h1>
<p>While Dr. Memory updates the <code>results.txt</code> file as the application runs, it does not perform leak checking or produce a summary of errors until the end of the run. For applications that do not have a normal exit, such as daemons, Dr. Memory provides a method of forcing end-of-run actions.</p>
<p>Run <code>drmemory</code> with the <code>-nudge</code> option and the process identifier of the application in order to request leak checking and other end-of-run actions:</p>
<pre class="fragment">drmemory.exe -nudge &lt;processid&gt;
</pre><h1><a class="anchor" id="sec_perf"></a>
Tuning for Performance</h1>
<p>Dr. Memory's default options are set up to find the most errors. Several key options can be adjusted to improve performance, at the cost of less information on each error report or even identification of fewer error types. Reducing <code>-malloc_max_frames</code>, disabling <code>-delay_frees_stack</code>, and disabling leak checking can improve performance on malloc-intensive applications. For more significant improvements, consider using Dr. Memory's <a class="el" href="page_light.html">Light Mode</a>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer" style="float:none;text-align:center"><img border=0 src="favicon.png"> &nbsp;  Dr. Memory version 1.11.1 --- Fri Feb 3 2017 00:38:43 &nbsp; <img border=0 src="favicon.png">
</small></address>
<!--END !GENERATE_TREEVIEW-->
</body>
</html>
